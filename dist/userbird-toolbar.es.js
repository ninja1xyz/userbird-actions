const R = (c) => `<svg id="Layer_1" href="${c}" xmlns="http://www.w3.org/2000/svg" version="1.1" height="35" width="120" viewBox="0 0 421.39 96.87" style="margin-right: 10px;">Add commentMore actions
  <defs>
    <style>
      .st0 {
        fill: #fff;
      }

      .st1 {
        fill: #f40;
      }

      .st2 {
        fill: #ffa200;
      }

      .st3 {
        fill: #009eff;
      }
    </style>
  </defs>
  <g>
    <path class="st0" d="M169.35,40h8.66v40.11h-8.66v-5.13c-2.62,4.12-6.77,6.18-12.43,6.18-4.6,0-8.32-1.47-11.15-4.41-2.84-2.94-4.25-6.98-4.25-12.11v-24.63h8.66v23.75c0,3,.8,5.29,2.41,6.9s3.8,2.41,6.58,2.41c3.05,0,5.51-.95,7.38-2.85,1.87-1.9,2.81-4.8,2.81-8.7v-21.5Z"/>
    <path class="st0" d="M193.97,51.07c0,1.34.73,2.39,2.21,3.17,1.47.78,3.26,1.44,5.38,2.01,2.11.56,4.24,1.22,6.38,1.97,2.14.75,3.94,2.02,5.42,3.81,1.47,1.79,2.21,4.05,2.21,6.78,0,3.85-1.48,6.87-4.45,9.06-2.97,2.19-6.7,3.29-11.19,3.29-3.96,0-7.35-.83-10.19-2.49-2.84-1.66-4.89-3.96-6.18-6.9l7.46-4.33c1.39,3.85,4.36,5.78,8.9,5.78s6.82-1.5,6.82-4.49c0-1.28-.74-2.33-2.21-3.13-1.47-.8-3.26-1.48-5.37-2.05-2.11-.56-4.24-1.22-6.38-1.97-2.14-.75-3.94-1.99-5.42-3.73-1.47-1.74-2.21-3.94-2.21-6.62,0-3.69,1.4-6.66,4.21-8.9s6.3-3.37,10.47-3.37c3.32,0,6.27.74,8.86,2.21,2.59,1.47,4.58,3.52,5.98,6.14l-7.3,4.09c-1.39-3.05-3.9-4.57-7.54-4.57-1.66,0-3.05.36-4.17,1.08s-1.68,1.78-1.68,3.17Z"/>
    <path class="st0" d="M227.27,63.74c.64,3.05,2.11,5.39,4.41,7.02,2.3,1.63,5.11,2.45,8.42,2.45,4.6,0,8.05-1.66,10.35-4.97l7.14,4.17c-3.96,5.83-9.81,8.74-17.57,8.74-6.53,0-11.79-1.99-15.8-5.98-4.01-3.98-6.02-9.02-6.02-15.12s1.98-11,5.94-15.04c3.96-4.04,9.04-6.06,15.24-6.06,5.88,0,10.71,2.06,14.48,6.18,3.77,4.12,5.66,9.12,5.66,15,0,.91-.11,2.11-.32,3.61h-31.93ZM227.19,56.68h23.58c-.59-3.26-1.94-5.72-4.05-7.38-2.11-1.66-4.59-2.49-7.42-2.49-3.21,0-5.88.88-8.02,2.65-2.14,1.77-3.5,4.17-4.09,7.22Z"/>
    <path class="st0" d="M274.11,46.74c2.19-4.97,6.31-7.46,12.35-7.46v9.39c-3.32-.21-6.2.58-8.66,2.37-2.46,1.79-3.69,4.75-3.69,8.86v20.21h-8.66v-40.11h8.66v6.74Z"/>
    <path class="st0" d="M313.9,38.95c5.51,0,10.21,2.03,14.12,6.1,3.9,4.07,5.86,9.06,5.86,15s-1.95,10.87-5.86,14.96c-3.9,4.09-8.61,6.14-14.12,6.14-6.1,0-10.78-2.27-14.04-6.82v5.78h-8.66V23.95h8.66v21.74c3.26-4.49,7.94-6.74,14.04-6.74ZM303.47,69.24c2.41,2.43,5.43,3.65,9.06,3.65s6.66-1.22,9.06-3.65c2.41-2.43,3.61-5.5,3.61-9.19s-1.2-6.75-3.61-9.18c-2.41-2.43-5.43-3.65-9.06-3.65s-6.66,1.22-9.06,3.65c-2.41,2.43-3.61,5.49-3.61,9.18s1.2,6.75,3.61,9.19Z"/>
    <path class="st0" d="M348.27,32.34c-1.1,1.1-2.39,1.64-3.89,1.64s-2.8-.55-3.89-1.64c-1.1-1.1-1.64-2.39-1.64-3.89s.53-2.79,1.6-3.89c1.07-1.1,2.38-1.64,3.93-1.64s2.86.55,3.93,1.64c1.07,1.1,1.6,2.39,1.6,3.89s-.55,2.8-1.64,3.89ZM340.05,80.11v-40.11h8.66v40.11h-8.66Z"/>
    <path class="st0" d="M365.72,46.74c2.19-4.97,6.31-7.46,12.35-7.46v9.39c-3.32-.21-6.2.58-8.66,2.37-2.46,1.79-3.69,4.75-3.69,8.86v20.21h-8.66v-40.11h8.66v6.74Z"/>
    <path class="st0" d="M412.73,23.95h8.66v56.15h-8.66v-5.78c-3.26,4.55-7.94,6.82-14.04,6.82-5.51,0-10.21-2.05-14.12-6.14-3.9-4.09-5.86-9.08-5.86-14.96s1.95-10.94,5.86-15c3.9-4.06,8.61-6.1,14.12-6.1,6.1,0,10.78,2.25,14.04,6.74v-21.74ZM390.99,69.24c2.41,2.43,5.43,3.65,9.06,3.65s6.66-1.22,9.06-3.65c2.41-2.43,3.61-5.5,3.61-9.19s-1.2-6.75-3.61-9.18c-2.41-2.43-5.43-3.65-9.06-3.65s-6.66,1.22-9.06,3.65c-2.41,2.43-3.61,5.49-3.61,9.18s1.2,6.75,3.61,9.19Z"/>
  </g>
  <g>
    <path class="st2" d="M0,0c0,.37,0,.84,0,1.23v39.73c0,21.53,17.61,39.14,39.14,39.14h40.96L0,0Z"/>
    <path class="st3" d="M56.84,56.84h20.48c10.76,0,19.57-8.81,19.57-19.57v-20.48l-40.05,40.05Z"/>
    <path class="st1" d="M96.89,96.87v-20.47c0-10.76-8.81-19.57-19.57-19.57h-20.48l40.05,40.04Z"/>
  </g>
</svg>`;
function Y(c) {
  return c && c.__esModule && Object.prototype.hasOwnProperty.call(c, "default") ? c.default : c;
}
function U(c) {
  if (Object.prototype.hasOwnProperty.call(c, "__esModule")) return c;
  var l = c.default;
  if (typeof l == "function") {
    var f = function d() {
      return this instanceof d ? Reflect.construct(l, arguments, this.constructor) : l.apply(this, arguments);
    };
    f.prototype = l.prototype;
  } else f = {};
  return Object.defineProperty(f, "__esModule", { value: !0 }), Object.keys(c).forEach(function(d) {
    var y = Object.getOwnPropertyDescriptor(c, d);
    Object.defineProperty(f, d, y.get ? y : {
      enumerable: !0,
      get: function() {
        return c[d];
      }
    });
  }), f;
}
var p = { exports: {} };
const K = {}, P = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  default: K
}, Symbol.toStringTag, { value: "Module" })), _ = /* @__PURE__ */ U(P), S = "16.5.0", j = {
  version: S
};
var O;
function B() {
  if (O) return p.exports;
  O = 1;
  const c = _, l = _, f = _, d = _, m = j.version, g = /(?:^|^)\s*(?:export\s+)?([\w.-]+)(?:\s*=\s*?|:\s+?)(\s*'(?:\\'|[^'])*'|\s*"(?:\\"|[^"])*"|\s*`(?:\\`|[^`])*`|[^#\r\n]+)?\s*(?:#.*)?(?:$|$)/mg;
  function D(e) {
    const o = {};
    let r = e.toString();
    r = r.replace(/\r\n?/mg, `
`);
    let s;
    for (; (s = g.exec(r)) != null; ) {
      const u = s[1];
      let t = s[2] || "";
      t = t.trim();
      const n = t[0];
      t = t.replace(/^(['"`])([\s\S]*)\1$/mg, "$2"), n === '"' && (t = t.replace(/\\n/g, `
`), t = t.replace(/\\r/g, "\r")), o[u] = t;
    }
    return o;
  }
  function x(e) {
    const o = T(e), r = i.configDotenv({ path: o });
    if (!r.parsed) {
      const n = new Error(`MISSING_DATA: Cannot parse ${o} for an unknown reason`);
      throw n.code = "MISSING_DATA", n;
    }
    const s = w(e).split(","), u = s.length;
    let t;
    for (let n = 0; n < u; n++)
      try {
        const a = s[n].trim(), h = V(r, a);
        t = i.decrypt(h.ciphertext, h.key);
        break;
      } catch (a) {
        if (n + 1 >= u)
          throw a;
      }
    return i.parse(t);
  }
  function I(e) {
    console.log(`[dotenv@${m}][WARN] ${e}`);
  }
  function E(e) {
    console.log(`[dotenv@${m}][DEBUG] ${e}`);
  }
  function w(e) {
    return e && e.DOTENV_KEY && e.DOTENV_KEY.length > 0 ? e.DOTENV_KEY : process.env.DOTENV_KEY && process.env.DOTENV_KEY.length > 0 ? process.env.DOTENV_KEY : "";
  }
  function V(e, o) {
    let r;
    try {
      r = new URL(o);
    } catch (a) {
      if (a.code === "ERR_INVALID_URL") {
        const h = new Error("INVALID_DOTENV_KEY: Wrong format. Must be in valid uri format like dotenv://:key_1234@dotenvx.com/vault/.env.vault?environment=development");
        throw h.code = "INVALID_DOTENV_KEY", h;
      }
      throw a;
    }
    const s = r.password;
    if (!s) {
      const a = new Error("INVALID_DOTENV_KEY: Missing key part");
      throw a.code = "INVALID_DOTENV_KEY", a;
    }
    const u = r.searchParams.get("environment");
    if (!u) {
      const a = new Error("INVALID_DOTENV_KEY: Missing environment part");
      throw a.code = "INVALID_DOTENV_KEY", a;
    }
    const t = `DOTENV_VAULT_${u.toUpperCase()}`, n = e.parsed[t];
    if (!n) {
      const a = new Error(`NOT_FOUND_DOTENV_ENVIRONMENT: Cannot locate environment ${t} in your .env.vault file.`);
      throw a.code = "NOT_FOUND_DOTENV_ENVIRONMENT", a;
    }
    return { ciphertext: n, key: s };
  }
  function T(e) {
    let o = null;
    if (e && e.path && e.path.length > 0)
      if (Array.isArray(e.path))
        for (const r of e.path)
          c.existsSync(r) && (o = r.endsWith(".vault") ? r : `${r}.vault`);
      else
        o = e.path.endsWith(".vault") ? e.path : `${e.path}.vault`;
    else
      o = l.resolve(process.cwd(), ".env.vault");
    return c.existsSync(o) ? o : null;
  }
  function N(e) {
    return e[0] === "~" ? l.join(f.homedir(), e.slice(1)) : e;
  }
  function $(e) {
    !!(e && e.debug) && E("Loading env from encrypted .env.vault");
    const r = i._parseVault(e);
    let s = process.env;
    return e && e.processEnv != null && (s = e.processEnv), i.populate(s, r, e), { parsed: r };
  }
  function k(e) {
    const o = l.resolve(process.cwd(), ".env");
    let r = "utf8";
    const s = !!(e && e.debug);
    e && e.encoding ? r = e.encoding : s && E("No encoding is specified. UTF-8 is used by default");
    let u = [o];
    if (e && e.path)
      if (!Array.isArray(e.path))
        u = [N(e.path)];
      else {
        u = [];
        for (const h of e.path)
          u.push(N(h));
      }
    let t;
    const n = {};
    for (const h of u)
      try {
        const v = i.parse(c.readFileSync(h, { encoding: r }));
        i.populate(n, v, e);
      } catch (v) {
        s && E(`Failed to load ${h} ${v.message}`), t = v;
      }
    let a = process.env;
    return e && e.processEnv != null && (a = e.processEnv), i.populate(a, n, e), t ? { parsed: n, error: t } : { parsed: n };
  }
  function A(e) {
    if (w(e).length === 0)
      return i.configDotenv(e);
    const o = T(e);
    return o ? i._configVault(e) : (I(`You set DOTENV_KEY but you are missing a .env.vault file at ${o}. Did you forget to build it?`), i.configDotenv(e));
  }
  function M(e, o) {
    const r = Buffer.from(o.slice(-64), "hex");
    let s = Buffer.from(e, "base64");
    const u = s.subarray(0, 12), t = s.subarray(-16);
    s = s.subarray(12, -16);
    try {
      const n = d.createDecipheriv("aes-256-gcm", r, u);
      return n.setAuthTag(t), `${n.update(s)}${n.final()}`;
    } catch (n) {
      const a = n instanceof RangeError, h = n.message === "Invalid key length", v = n.message === "Unsupported state or unable to authenticate data";
      if (a || h) {
        const b = new Error("INVALID_DOTENV_KEY: It must be 64 characters long (or more)");
        throw b.code = "INVALID_DOTENV_KEY", b;
      } else if (v) {
        const b = new Error("DECRYPTION_FAILED: Please check your DOTENV_KEY");
        throw b.code = "DECRYPTION_FAILED", b;
      } else
        throw n;
    }
  }
  function L(e, o, r = {}) {
    const s = !!(r && r.debug), u = !!(r && r.override);
    if (typeof o != "object") {
      const t = new Error("OBJECT_REQUIRED: Please check the processEnv argument being passed to populate");
      throw t.code = "OBJECT_REQUIRED", t;
    }
    for (const t of Object.keys(o))
      Object.prototype.hasOwnProperty.call(e, t) ? (u === !0 && (e[t] = o[t]), s && E(u === !0 ? `"${t}" is already defined and WAS overwritten` : `"${t}" is already defined and was NOT overwritten`)) : e[t] = o[t];
  }
  const i = {
    configDotenv: k,
    _configVault: $,
    _parseVault: x,
    config: A,
    decrypt: M,
    parse: D,
    populate: L
  };
  return p.exports.configDotenv = i.configDotenv, p.exports._configVault = i._configVault, p.exports._parseVault = i._parseVault, p.exports.config = i.config, p.exports.decrypt = i.decrypt, p.exports.parse = i.parse, p.exports.populate = i.populate, p.exports = i, p.exports;
}
var Z = B();
const C = /* @__PURE__ */ Y(Z), F = C.config().parsed || {};
class W {
  constructor({ siteId: l, workspaceId: f }) {
    this.siteId = l, this.workspaceId = f, this.logoSvg = null, this.apiToken = null, this.toolbar = null, this.logoRender = null, this.config = null;
  }
  async setupImports() {
    this.config = F, this.logoSvg = R("www." + this.Domain + "/");
  }
  getApiTokenFromHash() {
    return new URLSearchParams(window.location.hash.substring(1)).get("birdAuth");
  }
  getApiUrl() {
    return this.config.Environment === "production" ? `https://api.${this.config.Domain}/api/profile/` : `https://staging-api.${this.config.Domain}/api/profile/`;
  }
  getSiteUrl() {
    return this.config.environment === "production" ? `https://${this.config.Domain}/api/profile/` : `https://staging.${this.config.Domain}/api/profile/`;
  }
  async fetchProfile() {
    return (await fetch(this.getApiUrl(), {
      method: "GET",
      headers: {
        "Content-Type": "application/json",
        Authorization: "Bearer " + this.apiToken
      }
    })).ok;
  }
  createToolbar() {
    this.toolbar = document.createElement("div"), this.toolbar.id = "userbird-toolbar", Object.assign(this.toolbar.style, {
      position: "fixed",
      bottom: "20px",
      right: "20px",
      background: "#222",
      color: "#fff",
      padding: "10px 20px",
      borderRadius: "6px",
      boxShadow: "0 2px 8px rgba(0,0,0,0.15)",
      zIndex: "9999",
      cursor: "move"
    });
    const l = `${this.getSiteUrl() || this.config.Localhost}/${this.workspaceId}/site/${this.siteId}`;
    this.toolbar.innerHTML = `
      <div style="display:flex;justify-content:space-around;align-items:center;">
        <a style="text-decoration:none;color:white;" target="_blank" rel="noopener noreferrer">
          ${this.logoSvg.split(`
`).join("")}
        </a>
        |
        <a href="${l}" style="text-decoration:none;color:white;padding-top:5px;margin-left:10px;" target="_blank" rel="noopener noreferrer">
          Dashboard
        </a>
      </div>
    `, document.body.appendChild(this.toolbar), this.makeDraggable();
  }
  makeDraggable() {
    this.toolbar.onmousedown = (l) => {
      l.preventDefault();
      const f = l.clientX - this.toolbar.getBoundingClientRect().left, d = l.clientY - this.toolbar.getBoundingClientRect().top, y = (g, D) => {
        this.toolbar.style.left = g - f + "px", this.toolbar.style.top = D - d + "px", this.toolbar.style.right = "auto", this.toolbar.style.bottom = "auto", this.toolbar.style.position = "fixed";
      }, m = (g) => y(g.clientX, g.clientY);
      document.addEventListener("mousemove", m), document.onmouseup = () => {
        document.removeEventListener("mousemove", m), document.onmouseup = null;
      };
    }, this.toolbar.ondragstart = () => !1;
  }
  async init() {
    this.setupImports().then(async () => {
      this.apiToken = this.getApiTokenFromHash(), console.log(this.apiToken), this.apiToken && this.siteId && this.workspaceId && await this.fetchProfile() ? this.createToolbar() : console.warn("UserBird Redirection Unauthenticated.");
    });
  }
}
export {
  W as UserBirdToolbar,
  W as default
};
